---
title: "SQL"
output: html_document
---

## Filtering rows and Columns

With SQL,you can filter columns with SELECT and rows with WHERE. Let's look at an example using the Lahman baseball database. First, we need to load some packages. 

```{r warning=FALSE,message=FALSE}
library(Lahman)
library(sqldf)
```
Suppose we want to see the homerun totals for the 1927 Yankees. We can write the following:

```{r}
query<-"SELECT playerID,yearID,teamID,HR FROM Batting 
WHERE teamID='NYA' and yearID= 1927"
sqldf(query)

```
Suppose we want to see players from Yankees who hit 40 or more homeruns. We can write:
```{r}
query<-"SELECT playerID,yearID,teamID,HR FROM Batting
WHERE teamID= 'NYA' and HR>=40"

sqldf(query)
```
Now suppose we want to see players from every team that hit more than 40 homeruns but less than 60 strike outs. We would write:
```{r}
query<-"SELECT playerID,yearID,teamID,HR,SO FROM Batting
WHERE HR>40 and SO<60"

sqldf(query)

```
We want to look at players on the Phillies from the 1970s, who hit more than 30 homeruns
```{r}
query<-"SELECT playerID,yearID,teamID,HR FROM Batting
WHERE teamID='PHI'and HR>30 and yearID<=1979 and yearID>=1970"

sqldf(query)

```


## Order By
Below are examples using the "order by" code: 

Suppose we want to see every player that hit more than 50 homeruns with the most homeruns at the top of the list.
```{r}
query<-"SELECT playerID,yearID,teamID,HR FROM Batting
WHERE HR>50
ORDER BY HR DESC"
sqldf(query)




```
Finally, let's look at all the instances of a player striking out less than 10 times with at least 400 at-bats. 
```{r}
query<-"SELECT playerID,yearID,teamID,SO, AB FROM Batting
WHERE SO<10 and AB>=400
ORDER BY SO"
sqldf(query)

```

